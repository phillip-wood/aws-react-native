{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/home/phil/Workspace/aws-react-native/app/screens/add/AddSneaker.js\";\nimport React, { useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { connect } from \"react-redux\";\nimport Screen from \"../../componets/Screen\";\nimport { dbCreateUserSneaker } from \"../../../apis/database\";\nimport AppButton from \"../../componets/AppButton\";\nimport AppPicker from \"../../componets/AppPicker\";\nimport ImageInputList from \"../../componets/ImageInputList\";\nimport { s3CreateImage } from \"../../../apis/storage\";\n\nfunction AddSneaker(_ref) {\n  var authUser = _ref.authUser,\n      sneakers = _ref.sneakers;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      images = _useState2[0],\n      setImages = _useState2[1];\n\n  var _useState3 = useState('brand'),\n      _useState4 = _slicedToArray(_useState3, 2),\n      brand = _useState4[0],\n      setBrand = _useState4[1];\n\n  var _useState5 = useState('model'),\n      _useState6 = _slicedToArray(_useState5, 2),\n      model = _useState6[0],\n      setModel = _useState6[1];\n\n  var _useState7 = useState('submodel'),\n      _useState8 = _slicedToArray(_useState7, 2),\n      submodel = _useState8[0],\n      setSubmodel = _useState8[1];\n\n  var _useState9 = useState('condition'),\n      _useState10 = _slicedToArray(_useState9, 2),\n      condition = _useState10[0],\n      setCondition = _useState10[1];\n\n  var user_id = authUser.id;\n  var brands = [{\n    id: 1,\n    label: 'nike'\n  }, {\n    id: 2,\n    label: 'adidas'\n  }, {\n    id: 3,\n    label: 'air jordan'\n  }, {\n    id: 4,\n    label: 'yeezy'\n  }, {\n    id: 5,\n    label: 'converse'\n  }, {\n    id: 6,\n    label: 'new balance'\n  }, {\n    id: 7,\n    label: 'puma'\n  }, {\n    id: 8,\n    label: 'reebok'\n  }, {\n    id: 9,\n    label: 'under armour'\n  }, {\n    id: 10,\n    label: 'vans'\n  }];\n  var models = pickerList(sneakers, 'brand', 'model');\n  var submodels = pickerList(sneakers, 'model', 'submodel');\n  var conditions = [{\n    id: 1,\n    label: 'Deadstock'\n  }, {\n    id: 2,\n    label: 'VNDS'\n  }, {\n    id: 3,\n    label: 'Worn'\n  }, {\n    id: 4,\n    label: 'Beaters'\n  }];\n\n  function pickerList(array, key1, key2) {\n    var newArray = [];\n    var state = key1 === 'brand' ? brand : model;\n    array.map(function (sneaker, index) {\n      if (sneaker[key1] === state) {\n        newArray.push({\n          id: index,\n          label: sneaker[key2]\n        });\n      }\n    });\n\n    var newArray2 = _toConsumableArray(new Map(newArray.map(function (item) {\n      return [item.label, item];\n    })).values());\n\n    return newArray2;\n  }\n\n  var handleAdd = function handleAdd(uri) {\n    setImages(function (prevArray) {\n      return [].concat(_toConsumableArray(prevArray), [uri]);\n    });\n  };\n\n  var handleRemove = function handleRemove(uri) {\n    setImages(images.filter(function (imageUri) {\n      return imageUri !== uri;\n    }));\n  };\n\n  var handleUploadNewUserSneaker = function handleUploadNewUserSneaker() {\n    var imageLinks, i, link, sneakerFind, userSneakerSneakerId;\n    return _regeneratorRuntime.async(function handleUploadNewUserSneaker$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            imageLinks = [];\n            i = 0;\n\n          case 2:\n            if (!(i < images.length)) {\n              _context.next = 10;\n              break;\n            }\n\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(s3CreateImage(images[i], \"sneaker-pics\"));\n\n          case 5:\n            link = _context.sent;\n            imageLinks.push(link);\n\n          case 7:\n            i++;\n            _context.next = 2;\n            break;\n\n          case 10:\n            _context.next = 12;\n            return _regeneratorRuntime.awrap(sneakers.find(function (sneaker) {\n              return sneaker.brand === brand && sneaker.model === model && sneaker.submodel === submodel;\n            }));\n\n          case 12:\n            sneakerFind = _context.sent;\n            userSneakerSneakerId = sneakerFind.id;\n            dbCreateUserSneaker(user_id, condition, imageLinks, userSneakerSneakerId);\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(Screen, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }\n  }, React.createElement(ImageInputList, {\n    imageUris: images,\n    onRemoveImage: handleRemove,\n    onAddImage: handleAdd,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }\n  }), React.createElement(AppPicker, {\n    items: brands,\n    name: \"brand\",\n    placeholder: brand,\n    onSelectItem: function onSelectItem(text) {\n      return setBrand(text.label);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }\n  }), React.createElement(AppPicker, {\n    items: models,\n    name: \"model\",\n    placeholder: model,\n    onSelectItem: function onSelectItem(text) {\n      return setModel(text.label);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }\n  }), React.createElement(AppPicker, {\n    items: submodels,\n    name: \"submodel\",\n    placeholder: submodel,\n    onSelectItem: function onSelectItem(text) {\n      return setSubmodel(text.label);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }\n  }), React.createElement(AppPicker, {\n    items: conditions,\n    name: \"condition\",\n    placeholder: condition,\n    onSelectItem: function onSelectItem(text) {\n      return setCondition(text.label);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }\n  }), React.createElement(AppButton, {\n    title: 'Add sneaker',\n    onPress: function onPress() {\n      return handleUploadNewUserSneaker();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }\n  }));\n}\n\nfunction mapStateToProps(globalState) {\n  return {\n    authUser: globalState.authUser,\n    sneakers: globalState.sneakers\n  };\n}\n\nexport default connect(mapStateToProps)(AddSneaker);\nvar styles = StyleSheet.create({\n  container: {\n    padding: 10\n  }\n});","map":{"version":3,"sources":["/home/phil/Workspace/aws-react-native/app/screens/add/AddSneaker.js"],"names":["React","useState","connect","Screen","dbCreateUserSneaker","AppButton","AppPicker","ImageInputList","s3CreateImage","AddSneaker","authUser","sneakers","images","setImages","brand","setBrand","model","setModel","submodel","setSubmodel","condition","setCondition","user_id","id","brands","label","models","pickerList","submodels","conditions","array","key1","key2","newArray","state","map","sneaker","index","push","newArray2","Map","item","values","handleAdd","uri","prevArray","handleRemove","filter","imageUri","handleUploadNewUserSneaker","imageLinks","i","length","link","find","sneakerFind","userSneakerSneakerId","styles","container","text","mapStateToProps","globalState","StyleSheet","create","padding"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;;AAEA,SAASC,OAAT,QAAwB,aAAxB;AAEA,OAAOC,MAAP;AACA,SAASC,mBAAT;AACA,OAAOC,SAAP;AACA,OAAOC,SAAP;AACA,OAAOC,cAAP;AACA,SAASC,aAAT;;AAEA,SAASC,UAAT,OAA4C;AAAA,MAAtBC,QAAsB,QAAtBA,QAAsB;AAAA,MAAZC,QAAY,QAAZA,QAAY;;AAAA,kBAEbV,QAAQ,CAAC,EAAD,CAFK;AAAA;AAAA,MAEnCW,MAFmC;AAAA,MAE3BC,SAF2B;;AAAA,mBAGhBZ,QAAQ,CAAC,OAAD,CAHQ;AAAA;AAAA,MAGnCa,KAHmC;AAAA,MAG5BC,QAH4B;;AAAA,mBAIhBd,QAAQ,CAAC,OAAD,CAJQ;AAAA;AAAA,MAInCe,KAJmC;AAAA,MAI5BC,QAJ4B;;AAAA,mBAKThB,QAAQ,CAAC,UAAD,CALC;AAAA;AAAA,MAKnCiB,QALmC;AAAA,MAKzBC,WALyB;;AAAA,mBAMRlB,QAAQ,CAAC,WAAD,CANA;AAAA;AAAA,MAMnCmB,SANmC;AAAA,MAMxBC,YANwB;;AAO1C,MAAMC,OAAO,GAAGZ,QAAQ,CAACa,EAAzB;AAGA,MAAIC,MAAM,GAAG,CAAC;AAACD,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAAD,EAAuB;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAAvB,EAA+C;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAA/C,EAA2E;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAA3E,EAAkG;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAAlG,EAA4H;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAA5H,EAAyJ;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAAzJ,EAA+K;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAA/K,EAAuM;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAAvM,EAAqO;AAACF,IAAAA,EAAE,EAAC,EAAJ;AAAQE,IAAAA,KAAK,EAAC;AAAd,GAArO,CAAb;AACA,MAAIC,MAAM,GAAGC,UAAU,CAAGhB,QAAH,EAAa,OAAb,EAAsB,OAAtB,CAAvB;AACA,MAAIiB,SAAS,GAAGD,UAAU,CAAGhB,QAAH,EAAa,OAAb,EAAsB,UAAtB,CAA1B;AACA,MAAIkB,UAAU,GAAG,CAAC;AAAEN,IAAAA,EAAE,EAAC,CAAL;AAAQE,IAAAA,KAAK,EAAC;AAAd,GAAD,EAA6B;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAA7B,EAAmD;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAAnD,EAAyE;AAACF,IAAAA,EAAE,EAAC,CAAJ;AAAOE,IAAAA,KAAK,EAAC;AAAb,GAAzE,CAAjB;;AAEA,WAASE,UAAT,CAAsBG,KAAtB,EAA6BC,IAA7B,EAAmCC,IAAnC,EAA0C;AACxC,QAAIC,QAAQ,GAAG,EAAf;AACA,QAAIC,KAAK,GAAIH,IAAI,KAAK,OAAV,GAAqBjB,KAArB,GAA6BE,KAAzC;AACAc,IAAAA,KAAK,CAACK,GAAN,CAAW,UAACC,OAAD,EAAUC,KAAV,EAAoB;AAAE,UAAKD,OAAO,CAACL,IAAD,CAAP,KAAkBG,KAAvB,EAA8B;AAAED,QAAAA,QAAQ,CAACK,IAAT,CAAgB;AAAEf,UAAAA,EAAE,EAAEc,KAAN;AAAaZ,UAAAA,KAAK,EAAEW,OAAO,CAACJ,IAAD;AAA3B,SAAhB;AAAuD;AAAE,KAA1H;;AACA,QAAMO,SAAS,sBAAO,IAAIC,GAAJ,CAAQP,QAAQ,CAACE,GAAT,CAAa,UAAAM,IAAI;AAAA,aAAI,CAACA,IAAI,CAAChB,KAAN,EAAagB,IAAb,CAAJ;AAAA,KAAjB,CAAR,EAAkDC,MAAlD,EAAP,CAAf;;AACA,WAAOH,SAAP;AACD;;AAED,MAAMI,SAAS,GAAG,SAAZA,SAAY,CAACC,GAAD,EAAS;AACzB/B,IAAAA,SAAS,CAAC,UAAAgC,SAAS;AAAA,0CAAOA,SAAP,IAAiBD,GAAjB;AAAA,KAAV,CAAT;AACD,GAFD;;AAIA,MAAME,YAAY,GAAG,SAAfA,YAAe,CAACF,GAAD,EAAS;AAC5B/B,IAAAA,SAAS,CACPD,MAAM,CAACmC,MAAP,CAAc,UAACC,QAAD;AAAA,aAAcA,QAAQ,KAAKJ,GAA3B;AAAA,KAAd,CADO,CAAT;AAGD,GAJD;;AAMA,MAAMK,0BAA0B,GAAG,SAA7BA,0BAA6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAC7BC,YAAAA,UAD6B,GAChB,EADgB;AAExBC,YAAAA,CAFwB,GAEtB,CAFsB;;AAAA;AAAA,kBAEnBA,CAAC,GAACvC,MAAM,CAACwC,MAFU;AAAA;AAAA;AAAA;;AAAA;AAAA,6CAGd5C,aAAa,CAACI,MAAM,CAACuC,CAAD,CAAP,EAAY,cAAZ,CAHC;;AAAA;AAG3BE,YAAAA,IAH2B;AAI/BH,YAAAA,UAAU,CAACZ,IAAX,CAAgBe,IAAhB;;AAJ+B;AAEFF,YAAAA,CAAC,EAFC;AAAA;AAAA;;AAAA;AAAA;AAAA,6CAMPxC,QAAQ,CAAC2C,IAAT,CAAc,UAAAlB,OAAO;AAAA,qBAAIA,OAAO,CAACtB,KAAR,KAAkBA,KAAlB,IAA2BsB,OAAO,CAACpB,KAAR,KAAkBA,KAA7C,IAAsDoB,OAAO,CAAClB,QAAR,KAAqBA,QAA/E;AAAA,aAArB,CANO;;AAAA;AAM3BqC,YAAAA,WAN2B;AAO3BC,YAAAA,oBAP2B,GAOJD,WAAW,CAAChC,EAPR;AAQjCnB,YAAAA,mBAAmB,CAAEkB,OAAF,EAAWF,SAAX,EAAsB8B,UAAtB,EAAkCM,oBAAlC,CAAnB;;AARiC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAnC;;AAWA,SACE,oBAAC,MAAD;AAAQ,IAAA,KAAK,EAAEC,MAAM,CAACC,SAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,cAAD;AAAgB,IAAA,SAAS,EAAG9C,MAA5B;AAAoC,IAAA,aAAa,EAAEkC,YAAnD;AAAiE,IAAA,UAAU,EAAEH,SAA7E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAEnB,MAAlB;AAA0B,IAAA,IAAI,EAAC,OAA/B;AAAuC,IAAA,WAAW,EAAEV,KAApD;AAA2D,IAAA,YAAY,EAAE,sBAAA6C,IAAI;AAAA,aAAI5C,QAAQ,CAAC4C,IAAI,CAAClC,KAAN,CAAZ;AAAA,KAA7E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,EAGE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAEC,MAAlB;AAA0B,IAAA,IAAI,EAAC,OAA/B;AAAuC,IAAA,WAAW,EAAEV,KAApD;AAA2D,IAAA,YAAY,EAAE,sBAAA2C,IAAI;AAAA,aAAI1C,QAAQ,CAAC0C,IAAI,CAAClC,KAAN,CAAZ;AAAA,KAA7E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,EAIE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAEG,SAAlB;AAA6B,IAAA,IAAI,EAAC,UAAlC;AAA6C,IAAA,WAAW,EAAEV,QAA1D;AAAoE,IAAA,YAAY,EAAE,sBAAAyC,IAAI;AAAA,aAAIxC,WAAW,CAACwC,IAAI,CAAClC,KAAN,CAAf;AAAA,KAAtF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJF,EAKE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAEI,UAAlB;AAA8B,IAAA,IAAI,EAAC,WAAnC;AAA+C,IAAA,WAAW,EAAET,SAA5D;AAAuE,IAAA,YAAY,EAAE,sBAAAuC,IAAI;AAAA,aAAItC,YAAY,CAACsC,IAAI,CAAClC,KAAN,CAAhB;AAAA,KAAzF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALF,EAME,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE,aAAlB;AAAiC,IAAA,OAAO,EAAE;AAAA,aAAMwB,0BAA0B,EAAhC;AAAA,KAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANF,CADF;AAUD;;AAED,SAASW,eAAT,CAA0BC,WAA1B,EAAuC;AACrC,SAAO;AACLnD,IAAAA,QAAQ,EAAEmD,WAAW,CAACnD,QADjB;AAELC,IAAAA,QAAQ,EAAEkD,WAAW,CAAClD;AAFjB,GAAP;AAID;;AAED,eAAeT,OAAO,CAAC0D,eAAD,CAAP,CAAyBnD,UAAzB,CAAf;AAEA,IAAMgD,MAAM,GAAGK,UAAU,CAACC,MAAX,CAAkB;AAC/BL,EAAAA,SAAS,EAAE;AACTM,IAAAA,OAAO,EAAE;AADA;AADoB,CAAlB,CAAf","sourcesContent":["import React, { useState } from \"react\"\nimport { StyleSheet } from \"react-native\"\nimport { connect } from \"react-redux\"\n\nimport Screen from \"../../componets/Screen\"\nimport { dbCreateUserSneaker } from '../../../apis/database'\nimport AppButton from \"../../componets/AppButton\"\nimport AppPicker from \"../../componets/AppPicker\"\nimport ImageInputList from \"../../componets/ImageInputList\"\nimport { s3CreateImage } from \"../../../apis/storage\"\n\nfunction AddSneaker({ authUser, sneakers }) {\n\n  const [images, setImages ] = useState([])\n  const [brand, setBrand] = useState('brand')\n  const [model, setModel] = useState('model')\n  const [submodel, setSubmodel ] = useState('submodel')\n  const [condition, setCondition] = useState('condition')\n  const user_id = authUser.id\n  \n\n  let brands = [{id:1, label:'nike'}, {id:2, label:'adidas'}, {id:3, label:'air jordan'}, {id:4, label:'yeezy'}, {id:5, label:'converse'}, {id:6, label:'new balance'}, {id:7, label:'puma'}, {id:8, label:'reebok'}, {id:9, label:'under armour'}, {id:10, label:'vans'}]\n  let models = pickerList ( sneakers, 'brand', 'model' )\n  let submodels = pickerList ( sneakers, 'model', 'submodel' )\n  let conditions = [{ id:1, label:'Deadstock'}, {id:2, label:'VNDS'}, {id:3, label:'Worn'}, {id:4, label:'Beaters'}]\n\n  function pickerList ( array, key1, key2 ) {\n    let newArray = []\n    let state = (key1 === 'brand') ? brand : model \n    array.map( (sneaker, index) => { if ( sneaker[key1] === state ){ newArray.push ( { id: index, label: sneaker[key2] } ) } } )\n    const newArray2 = [...new Map(newArray.map(item => [item.label, item])).values()]\n    return newArray2\n  }\n\n  const handleAdd = (uri) => {\n    setImages(prevArray =>[...prevArray,uri])\n  }\n\n  const handleRemove = (uri) => {\n    setImages(\n      images.filter((imageUri) => imageUri !== uri)\n    )\n  }\n\n  const handleUploadNewUserSneaker = async () => {\n    let imageLinks = [] \n    for (let i=0; i<images.length; i++){\n      let link = await s3CreateImage(images[i], \"sneaker-pics\")\n      imageLinks.push(link)\n    }\n    const sneakerFind = await sneakers.find(sneaker => sneaker.brand === brand && sneaker.model === model && sneaker.submodel === submodel)\n    const userSneakerSneakerId = sneakerFind.id\n    dbCreateUserSneaker( user_id, condition, imageLinks, userSneakerSneakerId )\n  }\n\n  return (\n    <Screen style={styles.container}>\n      <ImageInputList imageUris ={images} onRemoveImage={handleRemove} onAddImage={handleAdd}/>\n      <AppPicker items={brands} name=\"brand\" placeholder={brand} onSelectItem={text => setBrand(text.label)} />\n      <AppPicker items={models} name=\"model\" placeholder={model} onSelectItem={text => setModel(text.label)} />\n      <AppPicker items={submodels} name=\"submodel\" placeholder={submodel} onSelectItem={text => setSubmodel(text.label)} />\n      <AppPicker items={conditions} name=\"condition\" placeholder={condition} onSelectItem={text => setCondition(text.label)} />\n      <AppButton title={'Add sneaker'} onPress={() => handleUploadNewUserSneaker()}/>\n    </Screen>\n  )\n}\n\nfunction mapStateToProps (globalState) {\n  return {\n    authUser: globalState.authUser,\n    sneakers: globalState.sneakers \n  }\n}\n\nexport default connect(mapStateToProps)(AddSneaker)\n\nconst styles = StyleSheet.create({\n  container: {\n    padding: 10,\n  },\n})\n"]},"metadata":{},"sourceType":"module"}