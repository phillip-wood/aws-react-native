{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { Auth } from 'aws-amplify';\nimport { setAuthUser, updateUserName } from \"../actions/index\";\nimport { dbCreateUserInfo } from \"./database\";\nexport function createAuthUser(username, password, preferred_username, navigation) {\n  Auth.signUp({\n    username: username,\n    password: password,\n    attributes: {\n      preferred_username: preferred_username\n    }\n  }).then(function (res) {\n    return dbCreateUserInfo(res.userSub);\n  }).then(navigation.navigate('ConfirmSignUp')).catch(function (err) {\n    return console.log('❌ Error Signing Up', err);\n  });\n}\nexport function confirmAuthUser(username, authCode, navigation) {\n  return _regeneratorRuntime.async(function confirmAuthUser$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return _regeneratorRuntime.awrap(Auth.confirmSignUp(username, authCode).then(console.log('✅ Code confirmed')).then(navigation.navigate('Login')).catch(function (err) {\n            return alert(err.message);\n          }));\n\n        case 2:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n}\nexport function readAuthUser() {\n  return function (dispatch) {\n    return Auth.currentAuthenticatedUser({\n      bypassCache: false\n    }).then(function (user) {\n      dispatch(setAuthUser({\n        id: user.attributes.sub,\n        email: user.attributes.email,\n        username: user.attributes.preferred_username\n      }));\n      return null;\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  };\n}\nexport function updatePreferred_username(payload) {\n  return function (dispatch) {\n    return Auth.currentAuthenticatedUser().then(function (user) {\n      return Auth.updateUserAttributes(user, {\n        \"preferred_username\": payload\n      });\n    }).then(function (response) {\n      return alert(response);\n    }).then(dispatch(updateUserName(payload))).catch(function (err) {\n      return alert(err.message);\n    });\n  };\n}\nexport function updatePassword(oldPassword, newPassword) {\n  Auth.currentAuthenticatedUser().then(function (user) {\n    return Auth.changePassword(user, oldPassword, newPassword);\n  }).then(function (response) {\n    return alert(response);\n  }).catch(function (err) {\n    return alert(err.message);\n  });\n}","map":{"version":3,"sources":["/home/phil/Workspace/aws-react-native/apis/auth.js"],"names":["Auth","setAuthUser","updateUserName","dbCreateUserInfo","createAuthUser","username","password","preferred_username","navigation","signUp","attributes","then","res","userSub","navigate","catch","err","console","log","confirmAuthUser","authCode","confirmSignUp","alert","message","readAuthUser","dispatch","currentAuthenticatedUser","bypassCache","user","id","sub","email","updatePreferred_username","payload","updateUserAttributes","response","updatePassword","oldPassword","newPassword","changePassword"],"mappings":"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","sourcesContent":["import { Auth } from 'aws-amplify'\nimport { setAuthUser, updateUserName } from '../actions/index'\nimport { dbCreateUserInfo } from './database'\n\n//-----CREATE-----//\nexport function createAuthUser( username, password, preferred_username, navigation ) {\n    Auth.signUp({ username, password, attributes: { preferred_username } })\n        .then( res => dbCreateUserInfo( res.userSub ))\n        .then( navigation.navigate( 'ConfirmSignUp' ))\n        .catch( err => console.log( '❌ Error Signing Up' , err ))\n}\n\nexport async function confirmAuthUser( username, authCode, navigation ) {\n    await Auth.confirmSignUp(username, authCode)\n        .then( console.log( '✅ Code confirmed' ))\n        .then( navigation.navigate( 'Login' ))\n        .catch( err => alert( err.message ))\n}\n\n//-----READ-----//\nexport function readAuthUser () {\n    return dispatch => {\n        return Auth\n            .currentAuthenticatedUser({ bypassCache: false })\n            .then(user => { dispatch( setAuthUser({\n                id:user.attributes.sub, \n                email: user.attributes.email, \n                username: user.attributes.preferred_username\n                }))\n            return null\n            })\n            .catch( err => console.log(err))\n        }\n}\n\n//-----UPDATE-----//\nexport function updatePreferred_username( payload ) { \n    return dispatch => {\n        return Auth\n            .currentAuthenticatedUser()\n            .then( user => { return Auth.updateUserAttributes( user, { \"preferred_username\": payload })}) \n            .then( response => alert( response ))\n            .then( dispatch( updateUserName( payload )))\n            .catch( err => alert( err.message ))\n    }\n}\n\nexport function updatePassword( oldPassword, newPassword ) { \n    Auth.currentAuthenticatedUser()\n        .then( user => { return Auth.changePassword( user, oldPassword, newPassword ) \n        })\n        .then( response => alert( response )) \n        .catch( err => alert( err.message ))\n}\n"]},"metadata":{},"sourceType":"module"}